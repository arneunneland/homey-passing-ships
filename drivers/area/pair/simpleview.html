<script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" crossorigin=""></script>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
<script>
  var L = window.L;
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.4.2/leaflet.draw.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.4.2/leaflet.draw.css"/>

<style>
  #map { height: 250px; }
</style>
<script>
  console.log('start');
  Homey.setTitle("Velg område2T");
  Homey.emit('getArea', null)
    .then(data => {
      console.log('getArea response received');
    });

  console.log('readyBeforeTimeout');
  setTimeout(() => {
    console.log('readyAfterTimeout');
    var map = L.map('map').setView([62.4722, 6.1495], 11);
    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 15,
        attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
    }).addTo(map);

    setTimeout(() => {
      var drawControl = new L.Control.Draw();
      map.addControl(drawControl);

      var drawnFeatures = new L.FeatureGroup();
      map.addLayer(drawnFeatures);

      map.on('draw:created', function (e) {
        var type = e.layerType,
            layer = e.layer;

        console.log(e);
        drawnFeatures.addLayer(layer);
      });
    }, 1000);

  }, 2000)
  console.log('end');
</script>

<div id="area">
  <h3>Velg område2</h3>
  
  <div id="map"></div>
</div>